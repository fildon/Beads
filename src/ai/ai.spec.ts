import { evaluateStateForPlayer } from "./ai";

describe("AI", () => {
  it("recognises an immediate win", () => {
    const state: State = {
      nextToMove: "ðŸ”´",
      phase: "ðŸ”´",
      board: [
        ["âš«", "âš«", "âš«", "âš«", "âš«", "âš«", "âš«"],
        ["âš«", "âš«", "âš«", "âš«", "âš«", "âš«", "âš«"],
        ["âš«", "âš«", "âš«", "âš«", "âš«", "âš«", "âš«"],
        ["âš«", "âš«", "âš«", "âš«", "âš«", "âš«", "âš«"],
        ["âš«", "âš«", "âš«", "âš«", "âš«", "âš«", "âš«"],
        ["âš«", "âš«", "âš«", "ðŸ”´", "ðŸ”´", "ðŸ”´", "ðŸ”´"],
      ],
    };

    expect(evaluateStateForPlayer(state, "ðŸ”´")).toEqual({
      value: 1,
      timeToEnd: 0,
    });
  });

  it("recognises an immediate loss", () => {
    const state: State = {
      nextToMove: "ðŸ”´",
      phase: "ðŸ”´",
      board: [
        ["âš«", "âš«", "âš«", "âš«", "âš«", "âš«", "âš«"],
        ["âš«", "âš«", "âš«", "âš«", "âš«", "âš«", "âš«"],
        ["âš«", "âš«", "âš«", "âš«", "âš«", "âš«", "âš«"],
        ["âš«", "âš«", "âš«", "âš«", "âš«", "âš«", "âš«"],
        ["âš«", "âš«", "âš«", "âš«", "âš«", "âš«", "âš«"],
        ["âš«", "âš«", "âš«", "ðŸ”´", "ðŸ”´", "ðŸ”´", "ðŸ”´"],
      ],
    };

    expect(evaluateStateForPlayer(state, "ðŸŸ¡")).toEqual({
      value: -1,
      timeToEnd: 0,
    });
  });

  it("recognises a next move win", () => {
    const state: State = {
      nextToMove: "ðŸ”´",
      phase: "â–¶",
      board: [
        ["âš«", "âš«", "âš«", "âš«", "âš«", "âš«", "âš«"],
        ["âš«", "âš«", "âš«", "âš«", "âš«", "âš«", "âš«"],
        ["âš«", "âš«", "âš«", "âš«", "âš«", "âš«", "âš«"],
        ["âš«", "âš«", "âš«", "âš«", "âš«", "âš«", "âš«"],
        ["âš«", "âš«", "âš«", "âš«", "âš«", "âš«", "âš«"],
        ["âš«", "âš«", "âš«", "âš«", "ðŸ”´", "ðŸ”´", "ðŸ”´"],
      ],
    };

    expect(evaluateStateForPlayer(state, "ðŸ”´")).toEqual({
      value: 1,
      timeToEnd: 1,
    });
  });

  it("recognises a next move loss", () => {
    const state: State = {
      nextToMove: "ðŸ”´",
      phase: "â–¶",
      board: [
        ["âš«", "âš«", "âš«", "âš«", "âš«", "âš«", "âš«"],
        ["âš«", "âš«", "âš«", "âš«", "âš«", "âš«", "âš«"],
        ["âš«", "âš«", "âš«", "âš«", "âš«", "âš«", "âš«"],
        ["âš«", "âš«", "âš«", "âš«", "âš«", "âš«", "âš«"],
        ["âš«", "âš«", "âš«", "âš«", "âš«", "âš«", "âš«"],
        ["âš«", "âš«", "âš«", "âš«", "ðŸ”´", "ðŸ”´", "ðŸ”´"],
      ],
    };

    expect(evaluateStateForPlayer(state, "ðŸŸ¡")).toEqual({
      value: -1,
      timeToEnd: 1,
    });
  });
});
